<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="pointWishlist">

<!-- 찜 목록 등록 -->
<insert id="insert">
    INSERT INTO POINT_WISHLIST (
        POINT_WISHLIST_NO,
        POINT_WISHLIST_MEMBER_ID,
        POINT_WISHLIST_ITEM_NO
    )
    VALUES (
        SEQ_POINT_WISHLIST.NEXTVAL,
        #{memberId},
        #{itemNo}
    )
</insert>

<!-- 찜 목록 삭제 -->
<delete id="delete">
    DELETE FROM POINT_WISHLIST
    WHERE POINT_WISHLIST_MEMBER_ID = #{memberId}
      AND POINT_WISHLIST_ITEM_NO = #{itemNo}
</delete>

<!-- 찜 여부 확인 -->
<select id="checkWish" resultType="int">
    SELECT COUNT(*)
    FROM POINT_WISHLIST
    WHERE POINT_WISHLIST_MEMBER_ID = #{memberId}
      AND POINT_WISHLIST_ITEM_NO = #{itemNo}
</select>

<!-- 회원이 찜한 아이템 번호 목록 조회 -->
<select id="selectMyWishItemNos" resultType="long">
    SELECT POINT_WISHLIST_ITEM_NO
    FROM POINT_WISHLIST
    WHERE POINT_WISHLIST_MEMBER_ID = #{memberId}
</select>

<!-- 회원 찜 목록 조회 -->
<select id="selectMyWishlist" resultType="PointWishlistDto">
    SELECT 
        T1.POINT_WISHLIST_NO        AS pointWishlistNo,
        T1.POINT_WISHLIST_MEMBER_ID AS pointWishlistMemberId,
        T1.POINT_WISHLIST_ITEM_NO   AS pointWishlistItemNo,
        T1.POINT_WISHLIST_TIME      AS pointWishlistTime,

        T2.POINT_ITEM_NAME          AS pointItemName,
        T2.POINT_ITEM_SRC           AS pointItemSrc,
        T2.POINT_ITEM_PRICE         AS pointItemPrice
    FROM POINT_WISHLIST T1
    INNER JOIN POINT_ITEM_STORE T2
        ON T1.POINT_WISHLIST_ITEM_NO = T2.POINT_ITEM_NO
    WHERE T1.POINT_WISHLIST_MEMBER_ID = #{memberId}
    ORDER BY T1.POINT_WISHLIST_TIME DESC
</select>

</mapper>